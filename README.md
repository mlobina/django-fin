# Дипломный проект по курсу «Django: создание функциональных веб-приложений»

Проект API-сервиса и интерфейс администрирования для интернет-магазина.
В качестве фреймворка использованы Django и Django REST Framework.

## Описание API-сервиса

Сущности:

### Товар

url: `/api/v1/products/`

Поля:

- название
- описание
- цена
- дата создания
- дата обновления

Доступные действия: retrieve, list, create, update, destroy.

Создавать товары могут только админы. Смотреть могут все пользователи.

Имеется возможность фильтровать товары по цене и содержимому из названия / описания.

### Отзыв к товару

url: `/api/v1/product-reviews/`

- ID автора отзыва
- ID товара
- текст
- оценка от 1 до 5
- дата создания
- дата обновления

Доступные действия: retrieve, list, create, update, destroy.

Оставлять отзыв к товару могут только авторизованные пользователи. 1 пользователь не может оставлять более 1го отзыва.

Отзыв можно фильтровать по ID пользователя, дате создания и ID товара.

Пользователь может обновлять и удалять только свой собственный отзыв.

### Заказы

url: `/api/v1/orders/`

- ID пользователя
- позиции: каждая позиция состоит из товара и количества единиц
- статус заказа: NEW / IN_PROGRESS / DONE
- общая сумма заказа
- дата создания
- дата обновления

Доступные действия: retrieve, list, create, update, destroy.

Создавать заказы могут только авторизованные пользователи. Админы могут получать все заказы, остальное пользователи только свои.

Заказы можно фильтровать по статусу / общей сумме / дате создания / дате обновления и продуктам из позиций.

Менять статус заказа могут только админы.


### Подборки

url: `/api/v1/product-collections/`

- заголовок
- текст
- товары в подборке
- дата создания
- дата обновления

Доступные действия: retrieve, list, create, update, destroy

Создавать подборки могут только админы, остальные пользователи могут только их смотреть.


## Интерфейс администратора

* Редактирование и просмотр подборок.
* Редактирование и просмотр товаров.
* Просмотр списка заказов пользователей, отсортированных по дате создания, с указанием пользователя и количества товаров.
* Страница детализации заказа с просмотром списка заказанных товаров.
* Редактирование и просмотр отзывов.

## Тестирование

В качестве Test Runner'а используйте `pytest`.


## Документация по проекту

Для запуска проекта необходимо:

Клонировать репозиторий:

```
git clone https://github.com/mlobina/django-fin.git
cd django-fin
```
Создать и активировать виртуальное окружение:
```
python3 -m venv venv
source venv/bin/activate
```

Установить зависимости:

`pip install -r requirements.txt`

Cоздать базу в postgres, указать настройки подключения к БД в файле api_shop/settings.py 
```
...
`DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'api_shop',
        'USER': 'postgres',
        'PASSWORD': 'mypassword',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}`  
...
```
и выполнить миграции:  
`python manage.py migrate`

Выполнить команду:

`python manage.py runserver`

Перейти на соответствующий эндпоинт:

`http://127.0.0.1:8000/admin/`
`http://127.0.0.1:8000/api/v1/`

Для заполнения БД тестовыми данными:

`python manage.py loaddata fixtures.json`

Пользователь с правами администратора (is_staff):
username: admin-admin
password: 1234

Для запуска тестов:

Установить в настройках в разделе Python integrated tools Default test runner pytest.
Далее использовать команду:

`pytest`
